<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title data-ar="Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø³Ù…" data-en="Department Admin Dashboard">Department Admin Dashboard</title>

  <!-- Ø®Ø·ÙˆØ· Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„Ù‡ÙˆÙ… -->
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap" rel="stylesheet">

  <!-- Ù†ÙØ³ Ù…Ù„Ù Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ -->
  <link rel="stylesheet" href="dept-admin.css">
  <style>
    /* Ù„Ù…Ø³Ø© Ø¨Ø³ÙŠØ·Ø© Ù„ØªÙˆØ³ÙŠØ· Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ÙƒØ¨ÙŠØ±Ø© */
    .dashboard { flex-wrap: wrap; }
    .card.full { flex-basis: 100%; }
    .kpi-wrap { margin: 12px 40px; display: grid; grid-template-columns: repeat(4,minmax(160px,1fr)); gap: 14px; }
    .kpi { background:#fff; border:1px solid #e5e7eb; border-radius:14px; padding:14px; box-shadow:0 4px 10px rgba(0,0,0,.04); }
    .kpi .t{font-size:.92rem;color:#374151}
    .kpi .v{font-weight:800;font-size:1.35rem;color:#0f172a}
    .list-card{ background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:16px; box-shadow:0 4px 10px rgba(0,0,0,.04); margin:16px 40px 24px;}
    .comp-table{width:100%;border-collapse:collapse;font-size:.95rem}
    .comp-table th,.comp-table td{padding:10px 12px;border-bottom:1px solid #eee;text-align:center;white-space:nowrap}
    .comp-table thead th{background:#f8fafc;font-weight:600;position:sticky;top:0;z-index:1}
    .kpi-refresh{display:flex;align-items:center;justify-content:center;margin-top:10px}
    .refresh-btn{background:#3b82f6;color:white;border:none;border-radius:8px;padding:8px 12px;cursor:pointer;display:flex;align-items:center;gap:6px;font-size:.9rem;transition:all .2s ease}
    .refresh-btn:hover{background:#2563eb;transform:scale(1.05)}
    .refresh-btn:disabled{opacity:0.7;cursor:not-allowed}
    .refresh-btn svg{width:14px;height:14px}
    .animate-spin{animation:spin 1s linear infinite}
    @keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
  </style>
</head>
<body>
  <header class="header">
    <div class="header-content">
      <div class="header-title" data-ar="Ø¹ÙÙ€Ù€Ù€Ù€Ù€Ù€ÙˆÙ†ÙÙƒ â€” Ù…Ø¯ÙŠØ± Ø§Ù„Ù‚Ø³Ù…" data-en="AOUNAK â€” Department Admin">Ø¹ÙÙ€Ù€Ù€Ù€Ù€Ù€ÙˆÙ†ÙÙƒ â€” Ù…Ø¯ÙŠØ± Ø§Ù„Ù‚Ø³Ù…</div>
      <img src="/icon/hospital-logo.png" alt="Ø´Ø¹Ø§Ø±" class="header-logo"/>
<!-- Banner hidden by default -->
<div id="impersonation-banner" style="display:none; position:fixed; top:10px; left:10px; z-index:9999;">
  <button id="end-impersonation-btn"
          style="padding:8px 12px; border:none; border-radius:6px; background:#dc2626; color:#fff; cursor:pointer;">
    ğŸ”™ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³ÙˆØ¨Ø±
  </button>
</div>

      <a href="/login/profile.html" class="profile-link">
        <img src="/icon/patient1.png" class="profile-icon-small" alt="Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ">
        <span data-ar="Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ" data-en="Profile">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</span>
      </a>

      <button id="notifBtn" class="notif-btn" title="Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª">
        <svg class="notif-icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 2c.7 0 1.25.56 1.25 1.25v.51A6.75 6.75 0 0 1 19 10.5v4.06l1.49 2.49c.3.5-.06 1.12-.64 1.12H4.15c-.58 0-.94-.62-.64-1.12L5 14.56V10.5A6.75 6.75 0 0 1 10.75 3.76v-.51C10.75 2.56 11.3 2 12 2zm0 20a2.75 2.75 0 0 1-2.62-2h5.24A2.75 2.75 0 0 1 12 22z"/>
        </svg>
        <span id="notifCount" class="notif-count" style="display:none;">0</span>
      </button>

      <button id="langToggle" class="lang-toggle-btn">
        <img src="/icon/lang.png" class="lang-icon" alt="Ø§Ù„Ù„ØºØ©"/>
        <span id="langText">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© | English</span>
      </button>

      <button id="deptStatusBtn" class="dept-status-btn" onclick="showDepartmentStatus()" title="Department Status">
        <img src="/icon/info.png" class="status-icon" alt="Department Status"/>
        <span data-ar="Ø­Ø§Ù„Ø© Ø§Ù„Ù‚Ø³Ù…" data-en="Dept Status">Dept Status</span>
      </button>
    </div>
  </header>

  <main>
    <!-- ÙƒØ±ÙˆØª Ù…Ø¯ÙŠØ± Ø§Ù„Ù‚Ø³Ù… ÙÙ‚Ø· -->
    <section class="dashboard">
      <div class="card">
        <img src="/icon/chart.png" alt="">
        <h3 data-ar="Ù„ÙˆØ­Ø© Ø§Ù„Ù‚Ø³Ù…" data-en="Department Dashboard">Ù„ÙˆØ­Ø© Ø§Ù„Ù‚Ø³Ù…</h3>
        <p data-ar="Ù†Ø¸Ø±Ø© Ø´Ø§Ù…Ù„Ø© Ø¹Ù„Ù‰ Ø´ÙƒØ§ÙˆÙ‰ ÙˆØ·Ù„Ø¨Ø§Øª Ø§Ù„Ù‚Ø³Ù…" data-en="Overview of department complaints and requests">Ù†Ø¸Ø±Ø© Ø´Ø§Ù…Ù„Ø© Ø¹Ù„Ù‰ Ø´ÙƒØ§ÙˆÙ‰ ÙˆØ·Ù„Ø¨Ø§Øª Ø§Ù„Ù‚Ø³Ù…</p>
        <a href="/dept-admin/dept-dashboard.html" class="btn" data-ar="Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„" data-en="Open Dashboard">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</a>
      </div>

      <div class="card">
        <img src="/icon/group.png" alt="">
        <h3 data-ar="Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ù‚Ø³Ù…" data-en="Department Employees">Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ù‚Ø³Ù…</h3>
        <p data-ar="Ø¥Ø¯Ø§Ø±Ø© Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ù‚Ø³Ù… ÙˆØµÙ„Ø§Ø­ÙŠØ§ØªÙ‡Ù…" data-en="Manage department employees and permissions">Ø¥Ø¯Ø§Ø±Ø© Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ù‚Ø³Ù… ÙˆØµÙ„Ø§Ø­ÙŠØ§ØªÙ‡Ù…</p>
        <a href="/admin/department-management.html" class="btn" data-ar="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†" data-en="Manage Employees">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</a>
      </div>

      <div class="card">
        <img src="/icon/list.png" alt="">
        <h3 data-ar="Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„Ù‚Ø³Ù…" data-en="Department Complaints">Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„Ù‚Ø³Ù…</h3>
        <p data-ar="Ø¹Ø±Ø¶ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„Ù‚Ø³Ù…" data-en="View and manage department complaints">Ø¹Ø±Ø¶ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„Ù‚Ø³Ù…</p>
        <a href="/general complaints/general-complaints.html" class="btn" data-ar="Ø¹Ø±Ø¶ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰" data-en="View Complaints">Ø¹Ø±Ø¶ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰</a>
      </div>

      <div class="card">
        <img src="/icon/assignment.png" alt="">
        <h3 data-ar="ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰" data-en="Complaint Assignment">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰</h3>
        <p data-ar="ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ Ø¹Ù„Ù‰ Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ù‚Ø³Ù…" data-en="Assign complaints to department employees">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ Ø¹Ù„Ù‰ Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ù‚Ø³Ù…</p>
        <a href="#" onclick="openComplaintAssignment()" class="btn" data-ar="ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰" data-en="Assign Complaints">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰</a>
      </div>

      <div class="card">
        <img src="/icon/logs.png" alt="">
        <h3 data-ar="Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù‚Ø³Ù…" data-en="Department Logs">Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù‚Ø³Ù…</h3>
        <p data-ar="Ù…Ø±Ø§Ø¬Ø¹Ø© Ù†Ø´Ø§Ø·Ø§Øª Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ù‚Ø³Ù…" data-en="Review department employee activities">Ù…Ø±Ø§Ø¬Ø¹Ø© Ù†Ø´Ø§Ø·Ø§Øª Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ù‚Ø³Ù…</p>
        <a href="/admin/logs.html" class="btn" data-ar="Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„Ø§Øª" data-en="View Logs">Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„Ø§Øª</a>
      </div>

      <div class="card">
        <img src="/icon/permissions.png" alt="">
        <h3 data-ar="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª" data-en="Permission Management">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª</h3>
        <p data-ar="Ø¥Ø¯Ø§Ø±Ø© ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ù‚Ø³Ù…" data-en="Manage department employee permissions">Ø¥Ø¯Ø§Ø±Ø© ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ù‚Ø³Ù…</p>
        <a href="#" onclick="openDepartmentPermissions()" class="btn" data-ar="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª" data-en="Manage Permissions">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª</a>
      </div>
    </section>

    <!-- KPIs Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù‚Ø³Ù… -->
    <section class="kpi-wrap" id="kpiWrap">
      <div class="kpi"><div class="t" data-ar="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„Ù‚Ø³Ù…" data-en="Total Department Complaints">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„Ù‚Ø³Ù…</div><div class="v" id="kpiTotal">â€”</div></div>
      <div class="kpi"><div class="t" data-ar="Ø§Ù„Ù…ÙØªÙˆØ­Ø©" data-en="Open">Ø§Ù„Ù…ÙØªÙˆØ­Ø©</div><div class="v" id="kpiOpen">â€”</div></div>
      <div class="kpi"><div class="t" data-ar="Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©" data-en="In Progress">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©</div><div class="v" id="kpiWip">â€”</div></div>
      <div class="kpi"><div class="t" data-ar="Ø§Ù„Ù…ØºÙ„Ù‚Ø©" data-en="Closed">Ø§Ù„Ù…ØºÙ„Ù‚Ø©</div><div class="v" id="kpiClosed">â€”</div></div>
      <div class="kpi-refresh">
        <button onclick="refreshDashboardData()" class="refresh-btn" title="Refresh Dashboard Data" data-ar="ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª" data-en="Refresh Data">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M23 4v6h-6M1 20v-6h6M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"/>
          </svg>
        </button>
      </div>
    </section>

    <!-- Ø¢Ø®Ø± Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„Ù‚Ø³Ù… -->
    <section class="list-card">
      <div class="table-title" data-ar="Ø¢Ø®Ø± 10 Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„Ù‚Ø³Ù…" data-en="Latest 10 Department Complaints">Ø¢Ø®Ø± 10 Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„Ù‚Ø³Ù…</div>
      <table class="comp-table" id="complaintsTable">
        <thead>
          <tr>
            <th data-ar="Ø±Ù‚Ù… Ø§Ù„Ø´ÙƒÙˆÙ‰" data-en="Complaint ID">Ø±Ù‚Ù… Ø§Ù„Ø´ÙƒÙˆÙ‰</th>
            <th data-ar="Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„" data-en="Assigned Employee">Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</th>
            <th data-ar="Ø§Ù„Ø­Ø§Ù„Ø©" data-en="Status">Ø§Ù„Ø­Ø§Ù„Ø©</th>
            <th data-ar="ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…" data-en="Submission Date">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

  </main>

  <!-- Department Employees Modal -->
  <div id="employeesModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 data-ar="Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ù‚Ø³Ù…" data-en="Department Employees">Department Employees</h2>
        <span class="close" onclick="closeModal('employeesModal')">&times;</span>
      </div>
      <div class="modal-body">
        <!-- Search and Filters Section -->
        <div class="search-filters-section">
          <div class="search-bar">
            <input type="text" id="employeeSearch" placeholder="Search by Full Name or Employee ID..." data-ar-placeholder="Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¸Ù..." data-en-placeholder="Search by Full Name or Employee ID...">
            <button onclick="searchEmployees()" data-ar="Ø¨Ø­Ø«" data-en="Search">Search</button>
            <button onclick="clearEmployeeFilters()" data-ar="Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ±" data-en="Clear Filters">Clear Filters</button>
          </div>
          <div class="quick-filters">
            <select id="roleFilter" onchange="filterEmployees()">
              <option value="" data-ar="Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±" data-en="All Roles">All Roles</option>
              <option value="EMPLOYEE" data-ar="Ù…ÙˆØ¸Ù" data-en="Employee">Employee</option>
              <option value="ADMIN" data-ar="Ù…Ø¯ÙŠØ± Ù‚Ø³Ù…" data-en="Department Admin">Department Admin</option>
            </select>
            <select id="statusFilter" onchange="filterEmployees()">
              <option value="" data-ar="Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª" data-en="All Status">All Status</option>
              <option value="active" data-ar="Ù†Ø´Ø·" data-en="Active">Active</option>
              <option value="inactive" data-ar="ØºÙŠØ± Ù†Ø´Ø·" data-en="Inactive">Inactive</option>
            </select>
          </div>
        </div>

        <!-- Loading State -->
        <div id="employeesLoading" class="loading-overlay" style="display: none;">
          <div class="loading-spinner"></div>
        </div>

        <!-- Empty State -->
        <div id="employeesEmptyState" class="empty-state" style="display: none;">
          <p data-ar="Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† ÙÙŠ Ù‚Ø³Ù…Ùƒ" data-en="No employees found in your department">No employees found in your department</p>
          <button onclick="clearEmployeeFilters()" data-ar="Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ±" data-en="Clear Filters">Clear Filters</button>
        </div>

        <!-- Error State -->
        <div id="employeesErrorState" class="error-state" style="display: none;">
          <p data-ar="Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª" data-en="Error loading data">Error loading data</p>
          <button onclick="loadDepartmentEmployees()" data-ar="Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©" data-en="Retry">Retry</button>
        </div>

        <!-- Employees Table -->
        <div class="employees-table-container">
          <table id="employeesTable" class="data-table">
            <thead>
              <tr>
                <th onclick="sortEmployees('EmployeeID')" class="sortable" data-ar="Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¸Ù" data-en="Employee ID">Employee ID <span class="sort-icon">â†•</span></th>
                <th onclick="sortEmployees('FullName')" class="sortable" data-ar="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" data-en="Full Name">Full Name <span class="sort-icon">â†•</span></th>
                <th data-ar="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" data-en="Email">Email</th>
                <th data-ar="Ø§Ù„Ù‚Ø³Ù…" data-en="Department">Department</th>
                <th data-ar="Ø§Ù„Ø¯ÙˆØ±" data-en="Role">Role</th>
                <th data-ar="Ø§Ù„Ø­Ø§Ù„Ø©" data-en="Status">Status</th>
                <th data-ar="Ø§Ù„Ù‡Ø§ØªÙ" data-en="Phone">Phone</th>
                <th data-ar="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" data-en="Username">Username</th>
                <th data-ar="Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª" data-en="Actions">Actions</th>
              </tr>
            </thead>
            <tbody id="employeesTableBody">
              <!-- Employees will be loaded here -->
            </tbody>
          </table>
        </div>

        <!-- Pagination -->
        <div class="pagination" id="employeesPagination" style="display: none;">
          <button onclick="previousPage()" data-ar="Ø§Ù„Ø³Ø§Ø¨Ù‚" data-en="Previous">Previous</button>
          <span id="pageInfo" data-ar="Ø§Ù„ØµÙØ­Ø©" data-en="Page">Page</span>
          <button onclick="nextPage()" data-ar="Ø§Ù„ØªØ§Ù„ÙŠ" data-en="Next">Next</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Department Complaints Modal -->
  <div id="complaintsModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 data-ar="Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„Ù‚Ø³Ù…" data-en="Department Complaints">Department Complaints</h2>
        <span class="close" onclick="closeModal('complaintsModal')">&times;</span>
      </div>
      <div class="modal-body">
        <div class="search-bar">
          <input type="text" id="complaintSearch" placeholder="Search complaints..." data-ar-placeholder="Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰..." data-en-placeholder="Search complaints...">
          <button onclick="searchComplaints()" data-ar="Ø¨Ø­Ø«" data-en="Search">Search</button>
        </div>
        <div class="complaints-table-container">
          <table id="departmentComplaintsTable" class="data-table">
            <thead>
              <tr>
                <th data-ar="Ø±Ù‚Ù… Ø§Ù„Ø´ÙƒÙˆÙ‰" data-en="Complaint ID">Complaint ID</th>
                <th data-ar="Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„" data-en="Assigned Employee">Assigned Employee</th>
                <th data-ar="Ø§Ù„Ø­Ø§Ù„Ø©" data-en="Status">Status</th>
                <th data-ar="ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…" data-en="Submission Date">Submission Date</th>
                <th data-ar="Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª" data-en="Actions">Actions</th>
              </tr>
            </thead>
            <tbody id="departmentComplaintsTableBody">
              <!-- Complaints will be loaded here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Complaint Assignment Modal -->
  <div id="assignmentModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 data-ar="ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰" data-en="Complaint Assignment">Complaint Assignment</h2>
        <span class="close" onclick="closeModal('assignmentModal')">&times;</span>
      </div>
      <div class="modal-body">
        <div class="assignment-filters">
          <select id="complaintFilter" onchange="filterComplaintsForAssignment()">
            <option value="unassigned" data-ar="ØºÙŠØ± Ù…Ø®ØµØµØ©" data-en="Unassigned">Unassigned</option>
            <option value="all" data-ar="Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰" data-en="All Complaints">All Complaints</option>
          </select>
        </div>
                 <div class="assignment-table-container">
           <table id="assignmentTable" class="data-table">
             <thead>
               <tr>
                 <th data-ar="Ø±Ù‚Ù… Ø§Ù„Ø´ÙƒÙˆÙ‰" data-en="Complaint ID">Complaint ID</th>
                 <th data-ar="Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„" data-en="Assigned Employee">Assigned Employee</th>
                 <th data-ar="Ø§Ù„Ø­Ø§Ù„Ø©" data-en="Status">Status</th>
                 <th data-ar="ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…" data-en="Submission Date">Submission Date</th>
                 <th data-ar="Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª" data-en="Actions">Actions</th>
               </tr>
             </thead>
             <tbody id="assignmentTableBody">
               <!-- Assignment data will be loaded here -->
             </tbody>
           </table>
         </div>
      </div>
    </div>
  </div>

  <!-- Department Logs Modal -->
  <div id="logsModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 data-ar="Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù‚Ø³Ù…" data-en="Department Logs">Department Logs</h2>
        <span class="close" onclick="closeModal('logsModal')">&times;</span>
      </div>
      <div class="modal-body">
        <div class="logs-filters">
          <select id="logType" onchange="filterDepartmentLogs()">
            <option value="all" data-ar="Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø¬Ù„Ø§Øª" data-en="All Logs">All Logs</option>
            <option value="login" data-ar="ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„" data-en="Login">Login</option>
            <option value="complaint" data-ar="Ø´ÙƒØ§ÙˆÙ‰" data-en="Complaints">Complaints</option>
            <option value="assignment" data-ar="ØªÙˆØ²ÙŠØ¹" data-en="Assignment">Assignment</option>
          </select>
        </div>
        <div class="logs-table-container">
          <table id="departmentLogsTable" class="data-table">
            <thead>
              <tr>
                <th data-ar="Ø§Ù„ÙˆÙ‚Øª" data-en="Time">Time</th>
                <th data-ar="Ø§Ù„Ù…ÙˆØ¸Ù" data-en="Employee">Employee</th>
                <th data-ar="Ø§Ù„Ù†ÙˆØ¹" data-en="Type">Type</th>
                <th data-ar="Ø§Ù„ÙˆØµÙ" data-en="Description">Description</th>
              </tr>
            </thead>
            <tbody id="departmentLogsTableBody">
              <!-- Logs will be loaded here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Department Permissions Modal -->
  <div id="permissionsModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 data-ar="Ø¥Ø¯Ø§Ø±Ø© ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù‚Ø³Ù…" data-en="Department Permission Management">Department Permission Management</h2>
        <span class="close" onclick="closeModal('permissionsModal')">&times;</span>
      </div>
      <div class="modal-body">
        <div class="search-bar">
          <input type="text" id="permissionSearch" placeholder="Search by name or employee number..." data-ar-placeholder="Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¸Ù..." data-en-placeholder="Search by name or employee number...">
          <button onclick="searchEmployeesForPermissions()" data-ar="Ø¨Ø­Ø«" data-en="Search">Search</button>
        </div>
        <div class="permissions-table-container">
          <table id="permissionsTable" class="data-table">
            <thead>
              <tr>
                <th data-ar="Ø§Ù„Ø§Ø³Ù…" data-en="Name">Name</th>
                <th data-ar="Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¸Ù" data-en="Employee Number">Employee Number</th>
                <th data-ar="Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠ" data-en="Current Role">Current Role</th>
                <th data-ar="Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª" data-en="Permissions">Permissions</th>
                <th data-ar="Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª" data-en="Actions">Actions</th>
              </tr>
            </thead>
            <tbody id="permissionsTableBody">
              <!-- Permissions data will be loaded here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
     </div>

   <!-- Individual Assignment Modal -->
   <div id="individualAssignmentModal" class="modal">
     <div class="modal-content">
       <div class="modal-header">
         <h2 data-ar="ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø´ÙƒÙˆÙ‰" data-en="Assign Complaint">Assign Complaint</h2>
         <span class="close" onclick="closeIndividualAssignmentModal()">&times;</span>
       </div>
       <div class="modal-body">
         <!-- Loading State -->
         <div id="assignmentLoading" class="loading-overlay" style="display: none;">
           <div class="loading-spinner"></div>
           <p data-ar="Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†..." data-en="Loading employees...">Loading employees...</p>
         </div>
         
         <div class="form-group">
           <label for="employeeSelect" data-ar="Ø§Ø®ØªØ± Ù…ÙˆØ¸Ù:" data-en="Select Employee:">Select Employee:</label>
           <select id="employeeSelect" class="form-control">
             <option value="">Ø§Ø®ØªØ± Ù…ÙˆØ¸Ù...</option>
           </select>
         </div>
         <div class="modal-actions">
           <button onclick="closeIndividualAssignmentModal()" class="btn-cancel" data-ar="Ø¥Ù„ØºØ§Ø¡" data-en="Cancel">Cancel</button>
           <button onclick="confirmAssignment()" class="btn-confirm" data-ar="ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªÙˆØ²ÙŠØ¹" data-en="Confirm Assignment">Confirm Assignment</button>
         </div>
       </div>
     </div>
   </div>

   <!-- Edit Permissions Modal -->
   <div id="editPermissionsModal" class="modal">
     <div class="modal-content">
       <div class="modal-header">
         <h2 data-ar="ØªØ¹Ø¯ÙŠÙ„ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ¸Ù" data-en="Edit Employee Permissions">Edit Employee Permissions</h2>
         <span class="close" onclick="closeEditPermissionsModal()">&times;</span>
       </div>
       <div class="modal-body">
         <!-- Loading State -->
         <div id="permissionsLoading" class="loading-overlay" style="display: none;">
           <div class="loading-spinner"></div>
           <p data-ar="Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª..." data-en="Loading permissions...">Loading permissions...</p>
         </div>
         
         <!-- Employee Info -->
         <div class="employee-info-section">
           <h3 id="employeeName" data-ar="Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù" data-en="Employee Name">Employee Name</h3>
           <p id="employeeDetails" data-ar="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù" data-en="Employee Details">Employee Details</p>
         </div>
         
         <!-- Permissions Section -->
         <div class="permissions-section">
           <h4 data-ar="Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©" data-en="Available Permissions">Available Permissions</h4>
           <div class="permissions-grid" id="permissionsGrid">
             <!-- Permissions checkboxes will be loaded here -->
           </div>
         </div>
         
         <div class="modal-actions">
           <button onclick="closeEditPermissionsModal()" class="btn-cancel" data-ar="Ø¥Ù„ØºØ§Ø¡" data-en="Cancel">Cancel</button>
           <button onclick="saveEmployeePermissions()" class="btn-confirm" data-ar="Ø­ÙØ¸ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª" data-en="Save Permissions">Save Permissions</button>
         </div>
       </div>
     </div>
   </div>

      <script src="./dept-admin.js"></script>
   <script>
   (function () {
     // Ø§Ø³ØªØ®Ø¯Ù…ÙŠ Ù†ÙØ³ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø¹Ù†Ø¯Ùƒ: localStorage.user ÙŠØ­ØªÙˆÙŠ RoleID
     function redirectByRole() {
       const user = JSON.parse(localStorage.getItem('user') || 'null');

       const roleId = Number(user.RoleID || user.roleId);
       if (roleId === 1) return '/superadmin/superadmin-home.html'; // Ø³ÙˆØ¨Ø± Ø£Ø¯Ù…Ù†
       if (roleId === 2) return '/employee/employee-home.html';   // Ù…ÙˆØ¸Ù
       if (roleId === 3) return '/dept-admin/dept-admin.html';     // Ø£Ø¯Ù…Ù†
     }

     // ÙƒÙ„ Ø±ÙˆØ§Ø¨Ø· "Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©" Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ
     const homeLinks = document.querySelectorAll(
       'aside .sidebar-menu a.menu-link[href$="/login/home.html"], aside .sidebar-menu a.menu-link[data-en="Home Page"], aside .sidebar-menu a.menu-link[data-ar="Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"]'
     );

     homeLinks.forEach(a => {
       // Ø®ÙÙ„Ù‘ÙŠ Ø§Ù„Ù†Ù‚Ø± ÙŠÙˆØ¬Ù‘Ù‡ Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ±
       a.addEventListener('click', (e) => {
         e.preventDefault();
         window.location.href = redirectByRole();
       });

       // (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) Ø¹Ø¯Ù‘Ù„ÙŠ Ø§Ù„Ù€ href Ø§Ù„Ø¸Ø§Ù‡Ø± Ù„Ù„Ù€ Hover/Copy
       a.setAttribute('href', redirectByRole());
     });
   })();
   </script>
</body>
</html>
