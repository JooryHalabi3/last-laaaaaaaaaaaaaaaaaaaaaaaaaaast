<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ูุคุดุฑ ุจุฑูุณูุจู</title>

  <!-- Tailwind CSS -->
  <link rel="stylesheet" href="pressganey.css">
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <!-- Chart.js + Plugins -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>

  <!-- Excel Import -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <!-- Export PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>

<body class="flex h-screen overflow-hidden lang-ar">
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <div class="header-title" data-ar="ุนููููููููููู" data-en="AOUNAK">ุนููููููููููู</div>
      <img src="/icon/hospital-logo.png" alt="ุดุนุงุฑ ุงููุณุชุดูู" class="header-logo">
      <button id="langToggle" class="lang-toggle-btn">
        <img src="/icon/lang.png" alt="language" class="lang-icon" />
        <span id="langText">ุงูุนุฑุจูุฉ | English</span>
      </button>
    </div>
  </header>

  <!-- Sidebar -->
  <aside>
    <ul class="sidebar-menu">
      <li><a href="/login/login.html" class="menu-link" data-ar="ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ" data-en="Home Page">ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ</a></li>
      <li><a href="overview.html" class="menu-link" data-ar="ูุธุฑุฉ ุนุงูุฉ" data-en="Overview">ูุธุฑุฉ ุนุงูุฉ</a></li>
      <li><a href="report-937.html" class="menu-link" data-ar="ูุคุดุฑ ุจูุงุบุงุช 937" data-en="937 Report Index">ูุคุดุฑ ุจูุงุบุงุช 937</a></li>
      <li><a href="misconduct.html" class="menu-link" data-ar="ุจูุงุบุงุช ุณูุก ุงูุชุนุงูู" data-en="Misconduct Reports">ุจูุงุบุงุช ุณูุก ุงูุชุนุงูู</a></li>
      <li><a href="pressganey.html" class="menu-link active" data-ar="ูุคุดุฑ ุจุฑูุณูุจู" data-en="Press Ganey Index">ูุคุดุฑ ุจุฑูุณูุจู</a></li>
      <li><a href="inperson-complaints.html" class="menu-link" data-ar="ูุคุดุฑ ุงูุดูุงูู ุงูุญุถูุฑูุฉ" data-en="In-person Complaints">ูุคุดุฑ ุงูุดูุงูู ุงูุญุถูุฑูุฉ</a></li>
      <li><a href="secret-visitor.html" class="menu-link" data-ar="ููุงุญุธุงุช ุงูุฒุงุฆุฑ ุงูุณุฑู" data-en="Secret Visitor Notes">ููุงุญุธุงุช ุงูุฒุงุฆุฑ ุงูุณุฑู</a></li>
      <li><a href="general-requests.html" class="menu-link" data-ar="ูุคุดุฑ ุงูุทูุจุงุช ุงูุนุงูุฉ" data-en="General Requests Index">ูุคุดุฑ ุงูุทูุจุงุช ุงูุนุงูุฉ</a></li>
    </ul>
  </aside>

  <!-- Main Content -->
  <div class="flex-1 flex flex-col p-8 overflow-auto" style="margin-right: 250px; margin-top: 75px;">
    
    <!-- ุดุฑูุท ุงูุชุญูู -->
    <div class="flex flex-wrap gap-3 items-center justify-center mb-6">
      <input id="excelInput" type="file" multiple accept=".xlsx,.xls" class="hidden">
      <button id="importExcelBtn" class="bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-2 px-5 rounded-full shadow flex items-center">
        <i class="fas fa-file-excel ml-2"></i>
        <span data-ar="ุงุณุชูุฑุงุฏ ูููุงุช ุฅูุณู" data-en="Import Excel Files">ุงุณุชูุฑุงุฏ ูููุงุช ุฅูุณู</span>
      </button>

      <button id="saveToServerBtn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-5 rounded-full shadow flex items-center">
        <i class="fas fa-save ml-2"></i>
        <span data-ar="ุญูุธ (ูุญูููุง)" data-en="Save (Local)">ุญูุธ (ูุญูููุง)</span>
      </button>
    </div>

    <!-- ุงููุฑูุช -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
      <div class="bg-white rounded-lg shadow-md p-6 flex flex-col items-center justify-center text-center">
        <p class="text-sm text-gray-500 mb-2" data-ar="ุฅุฌูุงูู ุงูุฃูุณุงู ุงูุชู ุจูุบุช ูุณุจุฉ ุชูููุฐ ุงูุงุณุชุจูุงู" data-en="Total departments that reached survey completion rate">ุฅุฌูุงูู ุงูุฃูุณุงู ุงูุชู ุจูุบุช ูุณุจุฉ ุชูููุฐ ุงูุงุณุชุจูุงู</p>
        <p class="text-4xl font-bold text-blue-600" id="totalDepartmentsSurvey">0</p>
      </div>
      <div class="bg-white rounded-lg shadow-md p-6 flex flex-col items-center justify-center text-center">
        <p class="text-sm text-gray-500 mb-2" data-ar="ูุชูุณุท ูุชูุฌุฉ ุงูุฑุถุง ุงูุนุงู ูููุณุชุดูู" data-en="Average hospital general satisfaction score">ูุชูุณุท ูุชูุฌุฉ ุงูุฑุถุง ุงูุนุงู ูููุณุชุดูู</p>
        <p class="text-4xl font-bold text-green-600" id="averageSatisfactionScore">0.0</p>
      </div>
    </div>
<!-- ๐น ุงูููุงุชุฑ (ููู ุงููุฑุจุน ุงููุจูุฑ) -->
<div class="flex justify-end gap-3 mb-4">
  <select id="quarterFilter" class="border rounded-lg px-3 py-2 text-gray-700">
    <option value="" selected hidden>ุงุฎุชุฑ ุงูุฑุจุน</option>
    <option value="Q1">ุงูุฑุจุน ุงูุฃูู</option>
    <option value="Q2">ุงูุฑุจุน ุงูุซุงูู</option>
    <option value="Q3">ุงูุฑุจุน ุงูุซุงูุซ</option>
    <option value="Q4">ุงูุฑุจุน ุงูุฑุงุจุน</option>
  </select>

  <select id="yearFilter" class="border rounded-lg px-3 py-2 text-gray-700">
    <option value="" selected hidden>ุงุฎุชุฑ ุงูุณูุฉ</option>
    <option value="2023">2023</option>
    <option value="2024">2024</option>
    <option value="2025">2025</option>
    <option value="2026">2026</option>
    <option value="2027">2027</option>
  </select>
</div>

<!-- ุงููุฑุจุน ุงููุจูุฑ -->
<div class="bg-white rounded-lg shadow-md p-6 mb-8">
  <h2 class="text-xl font-semibold text-gray-800 mb-6 text-center">
    ูุณุจุฉ ุงูุฑุถุง ุงูุนุงู ูููุณุชุดูู
  </h2>
  <div class="chart-row">
    <div class="relative w-64 h-64"><canvas id="overallSatisfactionChart"></canvas></div>
    <div class="legend-side" id="legend-overall">
      <div class="legend-item">
        <span class="legend-left"><span class="legend-dot" style="background:#22C55E"></span>ุฑุงุถู</span>
        <span class="legend-pct" id="overall-satisfied">0%</span>
      </div>
      <div class="legend-item">
        <span class="legend-left"><span class="legend-dot" style="background:#EF4444"></span>ุบูุฑ ุฑุงุถู</span>
        <span class="legend-pct" id="overall-notSatisfied">0%</span>
      </div>
    </div>
  </div>
</div>

    

    <!-- ุงูุฏูุงุฆุฑ ุญุณุจ ุงููุณู -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
      
      <!-- ูุซุงู: ุงูุทุจ ุงูููุฒูู -->
      <div class="bg-white rounded-lg shadow-md p-4">
        <h3 class="text-lg font-semibold text-gray-800 mb-4 text-center">ุงูุทุจ ุงูููุฒูู</h3>
        <div class="chart-row">
          <div class="relative w-36 h-36 mx-auto"><canvas id="homeMedicineChart"></canvas></div>
          <div class="legend-side">
            <div class="legend-item">
              <span class="legend-left"><span class="legend-dot" style="background:#22C55E"></span>ุฑุงุถู</span>
              <span class="legend-pct" id="homeMedicine-satisfied">0%</span>
            </div>
            <div class="legend-item">
              <span class="legend-left"><span class="legend-dot" style="background:#EF4444"></span>ุบูุฑ ุฑุงุถู</span>
              <span class="legend-pct" id="homeMedicine-notSatisfied">0%</span>
            </div>
          </div>
        </div>
      </div>

      <!-- ุงูุฃุดุนุฉ -->
      <div class="bg-white rounded-lg shadow-md p-4">
        <h3 class="text-lg font-semibold text-gray-800 mb-4 text-center">ุงูุฃุดุนุฉ</h3>
        <div class="chart-row">
          <div class="relative w-36 h-36 mx-auto"><canvas id="radiologyChart"></canvas></div>
          <div class="legend-side">
            <div class="legend-item">
              <span class="legend-left"><span class="legend-dot" style="background:#22C55E"></span>ุฑุงุถู</span>
              <span class="legend-pct" id="radiology-satisfied">0%</span>
            </div>
            <div class="legend-item">
              <span class="legend-left"><span class="legend-dot" style="background:#EF4444"></span>ุบูุฑ ุฑุงุถู</span>
              <span class="legend-pct" id="radiology-notSatisfied">0%</span>
            </div>
          </div>
        </div>
      </div>

      <!-- ุงูุนูุงุฏุงุช ุงูุฎุงุฑุฌูุฉ -->
      <div class="bg-white rounded-lg shadow-md p-4">
        <h3 class="text-lg font-semibold text-gray-800 mb-4 text-center">ุงูุนูุงุฏุงุช ุงูุฎุงุฑุฌูุฉ</h3>
        <div class="chart-row">
          <div class="relative w-36 h-36 mx-auto"><canvas id="outpatientChart"></canvas></div>
          <div class="legend-side">
            <div class="legend-item">
              <span class="legend-left"><span class="legend-dot" style="background:#22C55E"></span>ุฑุงุถู</span>
              <span class="legend-pct" id="outpatient-satisfied">0%</span>
            </div>
            <div class="legend-item">
              <span class="legend-left"><span class="legend-dot" style="background:#EF4444"></span>ุบูุฑ ุฑุงุถู</span>
              <span class="legend-pct" id="outpatient-notSatisfied">0%</span>
            </div>
          </div>
        </div>
      </div>

      <!-- ุงูุฃุณูุงู -->
      <div class="bg-white rounded-lg shadow-md p-4">
        <h3 class="text-lg font-semibold text-gray-800 mb-4 text-center">ุงูุฃุณูุงู</h3>
        <div class="chart-row">
          <div class="relative w-36 h-36 mx-auto"><canvas id="dentistryChart"></canvas></div>
          <div class="legend-side">
            <div class="legend-item">
              <span class="legend-left"><span class="legend-dot" style="background:#22C55E"></span>ุฑุงุถู</span>
              <span class="legend-pct" id="dentistry-satisfied">0%</span>
            </div>
            <div class="legend-item">
              <span class="legend-left"><span class="legend-dot" style="background:#EF4444"></span>ุบูุฑ ุฑุงุถู</span>
              <span class="legend-pct" id="dentistry-notSatisfied">0%</span>
            </div>
          </div>
        </div>
      </div>

      <!-- ุงูุทูุงุฑุฆ -->
      <div class="bg-white rounded-lg shadow-md p-4">
        <h3 class="text-lg font-semibold text-gray-800 mb-4 text-center">ุงูุทูุงุฑุฆ</h3>
        <div class="chart-row">
          <div class="relative w-36 h-36 mx-auto"><canvas id="emergencyChart"></canvas></div>
          <div class="legend-side">
            <div class="legend-item">
              <span class="legend-left"><span class="legend-dot" style="background:#22C55E"></span>ุฑุงุถู</span>
              <span class="legend-pct" id="emergency-satisfied">0%</span>
            </div>
            <div class="legend-item">
              <span class="legend-left"><span class="legend-dot" style="background:#EF4444"></span>ุบูุฑ ุฑุงุถู</span>
              <span class="legend-pct" id="emergency-notSatisfied">0%</span>
            </div>
          </div>
        </div>
      </div>

      <!-- ุงูุชูููู -->
      <div class="bg-white rounded-lg shadow-md p-4">
        <h3 class="text-lg font-semibold text-gray-800 mb-4 text-center">ุฃูุณุงู ุงูุชูููู</h3>
        <div class="chart-row">
          <div class="relative w-36 h-36 mx-auto"><canvas id="inpatientChart"></canvas></div>
          <div class="legend-side">
            <div class="legend-item">
              <span class="legend-left"><span class="legend-dot" style="background:#22C55E"></span>ุฑุงุถู</span>
              <span class="legend-pct" id="inpatient-satisfied">0%</span>
            </div>
            <div class="legend-item">
              <span class="legend-left"><span class="legend-dot" style="background:#EF4444"></span>ุบูุฑ ุฑุงุถู</span>
              <span class="legend-pct" id="inpatient-notSatisfied">0%</span>
            </div>
          </div>
        </div>
      </div>
<!-- ุงููููุงุช -->
<div class="bg-white rounded-lg shadow-md p-4">
  <h3 class="text-lg font-semibold text-gray-800 mb-4 text-center">ุงููููุงุช</h3>
  <div class="chart-row">
    <div class="relative w-36 h-36 mx-auto"><canvas id="mortalityChart"></canvas></div>
    <div class="legend-side">
      <div class="legend-item">
        <span class="legend-left"><span class="legend-dot" style="background:#22C55E"></span>ุฑุงุถู</span>
        <span class="legend-pct" id="mortality-satisfied">0%</span>
      </div>
      <div class="legend-item">
        <span class="legend-left"><span class="legend-dot" style="background:#EF4444"></span>ุบูุฑ ุฑุงุถู</span>
        <span class="legend-pct" id="mortality-notSatisfied">0%</span>
      </div>
    </div>
  </div>
</div>


      <!-- ุจูู ุงูุฏู -->
      <div class="bg-white rounded-lg shadow-md p-4">
        <h3 class="text-lg font-semibold text-gray-800 mb-4 text-center">ุจูู ุงูุฏู</h3>
        <div class="chart-row">
          <div class="relative w-36 h-36 mx-auto"><canvas id="bloodBankChart"></canvas></div>
          <div class="legend-side">
            <div class="legend-item">
              <span class="legend-left"><span class="legend-dot" style="background:#22C55E"></span>ุฑุงุถู</span>
              <span class="legend-pct" id="bloodBank-satisfied">0%</span>
            </div>
            <div class="legend-item">
              <span class="legend-left"><span class="legend-dot" style="background:#EF4444"></span>ุบูุฑ ุฑุงุถู</span>
              <span class="legend-pct" id="bloodBank-notSatisfied">0%</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ุฒุฑ ุงูุชุตุฏูุฑ -->
    <div class="flex justify-center mt-8">
      <button id="exportReportBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-full shadow-lg flex items-center">
        <i class="fas fa-download ml-2"></i>
        <span data-ar="ุชุตุฏูุฑ ุงูุชูุฑูุฑ" data-en="Export Report">ุชุตุฏูุฑ ุงูุชูุฑูุฑ</span>
      </button>
    </div>

  </div>
<script>
  (function () {
    // ุงุณุชุฎุฏูู ููุณ ุงูุชุฎุฒูู ุนูุฏู: localStorage.user ูุญุชูู RoleID
    function redirectByRole() {
      const user = JSON.parse(localStorage.getItem('user') || 'null');
      if (!user) return '/login/login.html';

      const roleId = Number(user.RoleID || user.roleId);
      if (roleId === 1) return '/superadmin/superadmin-home.html'; // ุณูุจุฑ ุฃุฏูู
      if (roleId === 2) return '/employee/employee-home.html';   // ููุธู
      if (roleId === 3) return '/dept-admin/dept-admin.html';      // ุฃุฏูู
      return '/login/login.html'; // ุงุญุชูุงุทู
    }

    // ูู ุฑูุงุจุท "ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ" ุงูููุฌูุฏุฉ ูู ุงูุดุฑูุท ุงูุฌุงูุจู
    const homeLinks = document.querySelectorAll(
      'aside .sidebar-menu a.menu-link[href$="/login/login.html"], aside .sidebar-menu a.menu-link[data-en="Home Page"], aside .sidebar-menu a.menu-link[data-ar="ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ"]'
    );

    homeLinks.forEach(a => {
      // ุฎูููู ุงูููุฑ ููุฌูู ุญุณุจ ุงูุฏูุฑ
      a.addEventListener('click', (e) => {
        e.preventDefault();
        window.location.href = redirectByRole();
      });

      // (ุงุฎุชูุงุฑู) ุนุฏููู ุงูู href ุงูุธุงูุฑ ููู Hover/Copy
      a.setAttribute('href', redirectByRole());
    });
  })();
</script>
  <script src="pressganey.js"></script>
</body>
</html>
