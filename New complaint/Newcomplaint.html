<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title data-ar="تقديم شكوى جديدة" data-en="New Complaint">تقديم شكوى جديدة</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="Newcomplaint.css" />
</head> 

<body>
  <header class="header">
    <div class="header-content">
      <div class="header-title" data-ar="عُــــــونَك" data-en="AOUNAK">عُــــــونَك</div>
      <img src="/icon/hospital-logo.png" alt="شعار المستشفى" class="header-logo">
      <button id="langToggle" class="lang-toggle-btn">
        <img src="/icon/lang.png" alt="language" class="lang-icon" />
        <span id="langText">العربية | English</span>
      </button>
    </div>
  </header>

  <div class="page-header">
    <h2 class="page-title" data-ar="تقديم شكوى جديدة" data-en="Submit New Complaint">تقديم شكوى جديدة</h2>

    <div class="back-button">
      <a href="#" onclick="goBack()">
        <img src="/icon/Back.png" alt="Back Icon" class="back-icon" />
        <span data-ar="عودة" data-en="Back">عودة</span>
      </a>
    </div>
  </div>

  <p class="page-subtitle"
     data-ar="يرجى تعبئة المعلومات بشكل دقيق لتسهيل معالجة شكواك"
     data-en="Please fill in the details accurately to help us process your complaint">
     يرجى تعبئة المعلومات بشكل دقيق لتسهيل معالجة شكواك
  </p>

  <main>
    
    <!-- بيانات المريض -->
    <section class="form-section">
      <h3>
        <img src="/icon/patient.png" class="icon-title" alt="أيقونة المريض" />
        <span data-ar="بيانات المريض / صاحب الشكوى" data-en="Patient / Complainant Info">بيانات المريض / صاحب الشكوى</span>
      </h3>
      <div class="form-grid">
        <input type="text" id="fullName"
               placeholder="الاسم الكامل للمريض"
               data-ar-placeholder="الاسم الكامل للمريض"
               data-en-placeholder="Full Name of Patient" />

        <input type="text" id="nationalId"
               placeholder="رقم الهوية / الإقامة"
               data-ar-placeholder="رقم الهوية / الإقامة"
               data-en-placeholder="National ID / Iqama" />

        <select id="gender" data-ar-placeholder="اختر الجنس" data-en-placeholder="Select Gender">
          <option value="" disabled selected data-ar="اختر الجنس" data-en="Select Gender">اختر الجنس</option>
          <option value="ذكر" data-ar="ذكر" data-en="Male">ذكر</option>
          <option value="أنثى" data-ar="أنثى" data-en="Female">أنثى</option>
        </select>

        <input type="text" id="mobile"
               placeholder="رقم الجوال"
               data-ar-placeholder="رقم الجوال"
               data-en-placeholder="Mobile Number" />
      </div>
    </section>

    <!-- بيانات الزيارة -->
    <section class="form-section">
      <h3>
        <img src="/icon/document1.png" class="icon-title" alt="أيقونة الزيارة" />
        <span data-ar="بيانات الزيارة" data-en="Visit Information">بيانات الزيارة</span>
      </h3>
      <div class="form-grid">
        <select id="department">
          <option disabled selected data-ar="اختر القسم" data-en="Select Department">اختر القسم</option>
        </select>

        <input type="date" id="visitDate"
               placeholder="تاريخ الزيارة"
               data-ar-placeholder="تاريخ الزيارة"
               data-en-placeholder="Visit Date" />
      </div>
    </section>

    <!-- تفاصيل الشكوى -->
    <section class="form-section">
      <h3>
        <img src="/icon/calendar.png" class="icon-title" alt="أيقونة الشكوى" />
        <span data-ar="تفاصيل الشكوى" data-en="Complaint Details">تفاصيل الشكوى</span>
      </h3>
      <div class="form-grid">
        <select id="mainType">
          <option disabled selected data-ar="اختر نوع الشكوى" data-en="Select Complaint Type">اختر نوع الشكوى</option>
        </select>

        <select id="subType">
          <option disabled selected data-ar="اختر التصنيف الفرعي" data-en="Select Subcategory">اختر التصنيف الفرعي</option>
        </select>

        <textarea id="details"
                  placeholder="يرجى شرح التفاصيل بدقة"
                  data-ar-placeholder="يرجى شرح التفاصيل بدقة (مثلاً: أين، مع من، ...)"
                  data-en-placeholder="Please describe the details clearly (e.g., where, with whom, etc.)">
        </textarea>
      </div>
    </section>

    <!-- المرفقات -->
    <section class="form-section">
      <h3>
        <img src="/icon/attachment .png" />
        <span data-ar="المرفقات" data-en="Attachments">المرفقات</span>
      </h3>

      <div class="attachments-container">
        <!-- منطقة رفع الملفات -->
        <div class="upload-zone" id="uploadZone">
          <input type="file" id="attachments" accept="image/*,.pdf,.doc,.docx" multiple style="display: none;" onchange="handleFileUpload(event)" />
          
          <div class="upload-content">
            <img src="/icon/attachment .png" alt="أيقونة إرفاق" class="upload-icon" />
            <div class="upload-text">
              <p data-ar="اضغط هنا لاختيار الملفات أو اسحبها" data-en="Click here to select files or drag them">
                اضغط هنا لاختيار الملفات أو اسحبها
              </p>
              <span class="file-types" data-ar="صور، PDF، Word (حد أقصى 15 ميجابايت)" data-en="Images, PDF, Word (max 15MB)">
                صور، PDF، Word (حد أقصى 15 ميجابايت)
              </span>
            </div>
          </div>
        </div>

        <!-- قائمة الملفات المرفقة -->
        <div class="attachments-list" id="attachmentsList" style="display: none;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <h4 data-ar="الملفات المرفقة" data-en="Attached Files">الملفات المرفقة</h4>
            <button type="button" onclick="document.getElementById('attachments').click()" class="add-more-btn">
              <img src="/icon/plus.png" alt="إضافة" style="width: 16px; height: 16px; margin-left: 8px;">
              <span data-ar="إضافة ملفات" data-en="Add Files">إضافة ملفات</span>
            </button>
          </div>
          <div class="files-grid" id="filesGrid"></div>
        </div>

        <!-- شريط التقدم -->
        <div class="upload-progress" id="uploadProgress" style="display: none;">
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
          </div>
          <span class="progress-text" id="progressText">0%</span>
        </div>
      </div>
    </section>

    <!-- زر الإرسال -->
    <div class="submit-btn">
      <button type="button"
              onclick="submitComplaint()"
              data-ar="إرسال الشكوى"
              data-en="Submit Complaint">
        إرسال الشكوى
      </button>
    </div>
</main>
<script src="Newcomplaint.js"></script>
<script>
  (function () {
    // استخدمي نفس التخزين عندك: localStorage.user يحتوي RoleID
    function redirectByRole() {
      const user = JSON.parse(localStorage.getItem('user') || 'null');
      if (!user) return '/home/home.html';

      const roleId = Number(user.RoleID || user.roleId);
      if (roleId === 1) return '/superadmin/superadmin-home.html'; // سوبر أدمن
      if (roleId === 2) return '/employee/employee-home.html';   // موظف
      if (roleId === 3) return '/home/admin-home.html';      // أدمن
      return '/home/home.html'; // احتياطي
    }

    // كل روابط "الصفحة الرئيسية" الموجودة في الشريط الجانبي
    const homeLinks = document.querySelectorAll(
      'aside .sidebar-menu a.menu-link[href$="/login/home.html"], aside .sidebar-menu a.menu-link[data-en="Home Page"], aside .sidebar-menu a.menu-link[data-ar="الصفحة الرئيسية"]'
    );

    homeLinks.forEach(a => {
      // خَلّي النقر يوجّه حسب الدور
      a.addEventListener('click', (e) => {
        e.preventDefault();
        window.location.href = redirectByRole();
      });

      // (اختياري) عدّلي الـ href الظاهر للـ Hover/Copy
      a.setAttribute('href', redirectByRole());
    });
  })();
</script>

</body>

</html>
